@page "/"
@inject NavigationManager navman
@inject IPersonaggioService personaggioService

@if(personaggio == null)
{
    <RadzenRow>
        @foreach (Personaggio personaggio in giocatore.Personaggi)
        {
            <RadzenColumn Size="6">
                <RadzenCard>
                    <RadzenRow>
                        <RadzenText>@personaggio.Nome</RadzenText>
                        <RadzenText>@personaggio.Sessione.Nome</RadzenText>
                    </RadzenRow>
                    <RadzenRow>
                        <RadzenColumn>
                            <RadzenButton ButtonStyle="ButtonStyle.Secondary" Icon="edit" Click="x => ApriScheda(personaggio)" />
                        </RadzenColumn>
                        <RadzenColumn>
                            <RadzenButton ButtonStyle="ButtonStyle.Danger" Icon="delete" Click="x => EliminaPersonaggio(personaggio)" />
                        </RadzenColumn>
                    </RadzenRow>
                </RadzenCard>
            </RadzenColumn>
        }
    </RadzenRow>
    <RadzenFab Style="position:fixed;bottom:1rem;right:1rem;" ButtonType="ButtonType.Button" ButtonStyle="ButtonStyle.Primary" Click="x => ApriScheda(new Personaggio())" Icon="add" />
}
else
{
    <SchedaPersonaggio personaggio="personaggio" OnSalva="ResettaPersonaggio" />
}



@code {
    List<Personaggio> Personaggi = new List<Personaggio>();
    [CascadingParameter]
    public Giocatore giocatore { get; set; } = new Giocatore();

    Personaggio? personaggio = null; 

    private void ApriScheda(Personaggio quale)
    {
        //Qui ci dev'essere del codice che fa in modo di assegnare la sessione al nuovo personaggio, se non ne ha già una
        personaggio = quale; 
    }

    private void ResettaPersonaggio()
    {
        personaggio = null; 
    }

    private async Task EliminaPersonaggio(Personaggio personaggio)
    {
        await personaggioService.EliminaPersonaggio(personaggio); 
    }
}
